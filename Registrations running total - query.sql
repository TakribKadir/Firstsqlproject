WITH
	REG_DATES AS (
		SELECT
			USER_ID,
			MIN(ORDER_DATE) AS REG_DATE
		FROM
			ORDERS
		GROUP BY
			USER_ID
	),
	REGISTRATIONS AS (
		SELECT
			DATE_TRUNC('month', REG_DATE)::DATE AS FOODR_MONTH,
			COUNT(DISTINCT USER_ID) AS REGS
		FROM
			REG_DATES
		GROUP BY
			FOODR_MONTH
	)
SELECT
	FOODR_MONTH,
	REGS,
	SUM(REGS) OVER (
		ORDER BY
			FOODR_MONTH ASC
	) AS REGS_RT
FROM
	REGISTRATIONS
ORDER BY
	FOODR_MONTH ASC
LIMIT
	3;